<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Générateur de Prompts OBNL</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
            color: #1e293b;
        }
        .container {
            max-width: 800px;
        }
        .bg-white {
            background-color: white;
        }
        .p-8 {
            padding: 2rem;
        }
        .rounded-2xl {
            border-radius: 1rem;
        }
        .shadow-lg {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .text-2xl {
            font-size: 1.5rem;
        }
        .font-bold {
            font-weight: 700;
        }
        .text-blue-900 {
            color: #1e3a8a;
        }
        .mb-4 {
            margin-bottom: 1rem;
        }
        .text-slate-600 {
            color: #475569;
        }
        .mb-4 {
            margin-bottom: 1rem;
        }
        .w-full {
            width: 100%;
        }
        .p-3 {
            padding: 0.75rem;
        }
        .border {
            border-width: 1px;
        }
        .border-slate-300 {
            border-color: #cbd5e1;
        }
        .rounded-lg {
            border-radius: 0.5rem;
        }
        .mb-4 {
            margin-bottom: 1rem;
        }
        .bg-blue-600 {
            background-color: #2563eb;
        }
        .hover:bg-blue-700:hover {
            background-color: #1d4ed8;
        }
        .text-white {
            color: white;
        }
        .py-3 {
            padding-top: 0.75rem;
            padding-bottom: 0.75rem;
        }
        .px-4 {
            padding-left: 1rem;
            padding-right: 1rem;
        }
        .transition-colors {
            transition-property: background-color, border-color, color, fill, stroke;
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
            transition-duration: 150ms;
        }
        .mt-6 {
            margin-top: 1.5rem;
        }
        .p-4 {
            padding: 1rem;
        }
        .bg-slate-100 {
            background-color: #f1f5f9;
        }
        .text-slate-800 {
            color: #1e293b;
        }
        .hidden {
            display: none;
        }
        .text-slate-500 {
            color: #64748b;
        }
        .text-center {
            text-align: center;
        }
        .text-blue-600 {
            color: #2563eb;
        }
    </style>
</head>
<body>

    <div class="container mx-auto px-6 py-12">
        <div class="flex-1 bg-white p-8 rounded-2xl shadow-lg">
            <h3 class="text-2xl font-bold text-blue-900 mb-4">Exemples de prompts</h3>
            <p class="text-slate-600 mb-4">Sélectionnez une tâche pour obtenir un prompt adapté que vous pourriez utiliser avec un outil d'IA.</p>
            <select id="prompt-select" class="w-full p-3 border border-slate-300 rounded-lg mb-4">
                <option value="">Sélectionnez une tâche...</option>
                <option value="rédiger un courriel de remerciement pour un bénévole">Rédiger un courriel de remerciement pour un bénévole</option>
                <option value="résumer un rapport financier annuel">Résumer un rapport financier annuel</option>
                <option value="créer un plan de communication pour un événement">Créer un plan de communication pour un événement</option>
                <option value="brainstormer des idées de levée de fonds">Brainstormer des idées de levée de fonds</option>
            </select>
            <button id="generate-prompt-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition-colors duration-300">Générer un prompt ✨</button>
            <div id="prompt-output" class="mt-6 p-4 bg-slate-100 rounded-lg text-slate-800 hidden">
                <p class="text-slate-500 text-center">Le prompt généré par l'IA apparaîtra ici.</p>
            </div>
            <div id="prompt-loading" class="mt-6 text-center text-blue-600 hidden">
                <p>Génération en cours...</p>
            </div>
        </div>
    </div>

    <script>
        async function callGeminiAPI(prompt, outputElement, loadingElement) {
            outputElement.innerHTML = '';
            outputElement.classList.add('hidden');
            loadingElement.classList.remove('hidden');

            const apiKey = "AIzaSyBlLzxf_jCEhw3LGBFiJWKyBUg64sFV0Zo";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

            const payload = { 
                contents: [{ 
                    parts: [{ text: prompt }] 
                }] 
            };

            let retries = 0;
            const maxRetries = 5;
            const initialDelay = 1000;

            const executeFetch = async () => {
                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const result = await response.json();
                    
                    const text = result?.candidates?.[0]?.content?.parts?.[0]?.text;
                    if (text) {
                        const formattedText = text.replace(/\n/g, '<br>');
                        outputElement.innerHTML = formattedText;
                        outputElement.classList.remove('hidden');
                    } else {
                        outputElement.innerHTML = "Désolé, je n'ai pas pu générer de réponse. Veuillez réessayer.";
                        outputElement.classList.remove('hidden');
                    }
                } catch (error) {
                    console.error('API call failed:', error);
                    if (retries < maxRetries) {
                        retries++;
                        const delay = initialDelay * Math.pow(2, retries);
                        console.log(`Retrying in ${delay}ms...`);
                        await new Promise(res => setTimeout(res, delay));
                        await executeFetch();
                    } else {
                        outputElement.innerHTML = "Une erreur est survenue lors de la connexion à l'API. Cela peut être dû aux paramètres de sécurité de la page d'intégration. Veuillez vérifier votre connexion et réessayer.";
                        outputElement.classList.remove('hidden');
                    }
                } finally {
                    loadingElement.classList.add('hidden');
                }
            };
            await executeFetch();
        }

        document.addEventListener('DOMContentLoaded', () => {
            const promptSelect = document.getElementById('prompt-select');
            const generatePromptBtn = document.getElementById('generate-prompt-btn');
            const promptOutput = document.getElementById('prompt-output');
            const promptLoading = document.getElementById('prompt-loading');
            
            generatePromptBtn.addEventListener('click', () => {
                const task = promptSelect.value;
                if (task) {
                    const prompt = `Rédigez un prompt efficace et précis pour une IA générative, afin de l'aider à accomplir la tâche suivante : "${task}". Donnez un seul exemple de prompt.`;
                    callGeminiAPI(prompt, promptOutput, promptLoading);
                } else {
                    promptOutput.innerHTML = "Veuillez sélectionner une tâche pour générer un prompt.";
                    promptOutput.classList.remove('hidden');
                }
            });
        });
    </script>
</body>
</html>
