<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Générateur de Prompts OBNL</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <div class="container mx-auto px-6 py-12">
        <div class="flex-1 bg-white p-8 rounded-2xl shadow-lg flex flex-col">
            <div class="flex-grow">
                <h3 class="text-2xl font-bold text-[#010132] mb-4">Exemples de prompts</h3>
                <p class="text-slate-600 mb-4">Sélectionnez une tâche pour obtenir un prompt adapté que vous pourriez utiliser avec un outil d'IA.</p>
                <select id="prompt-select" class="w-full p-3 border border-slate-300 rounded-lg mb-4 focus:ring-2 focus:ring-[#49b048] focus:border-[#49b048]">
                    <option value="">Sélectionnez une tâche...</option>
                    <option value="rédiger un courriel de remerciement pour un bénévole">Rédiger un courriel de remerciement</option>
                    <option value="résumer un rapport financier annuel">Résumer un rapport financier</option>
                    <option value="créer un plan de communication pour un événement">Créer un plan de communication</option>
                    <option value="brainstormer des idées de levée de fonds">Brainstormer des idées de levée de fonds</option>
                </select>
            </div>
            <div>
                <button id="generate-prompt-btn" class="w-full bg-[#49b048] hover:bg-[#3f993e] text-white font-bold py-3 px-4 rounded-lg transition-colors duration-300 disabled:bg-slate-400" disabled>Générer un prompt ✨</button>
                <div id="prompt-output" class="mt-6 p-4 bg-slate-100 rounded-lg text-slate-800 hidden"></div>
                <div id="prompt-loading" class="mt-6 text-center text-[#010132] hidden"><p>Génération en cours...</p></div>
            </div>
        </div>
    </div>

    <script>
        async function callGeminiAPI(prompt, outputElement, loadingElement) {
            outputElement.innerHTML = '';
            outputElement.classList.add('hidden');
            loadingElement.classList.remove('hidden');

            const proxyApiUrl = "https://gemini-proxy-notion.michael-araujo.workers.dev/"; 
            
            const payload = { 
                prompt: prompt 
            };

            const response = await fetch(proxyApiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            if (!response.ok) {
                outputElement.innerHTML = `Erreur lors de l'appel au proxy: ${response.statusText}`;
                outputElement.classList.remove('hidden');
                loadingElement.classList.add('hidden');
                return;
            }
            
            const result = await response.json();
            
            const text = result?.text;
            if (text) {
                const formattedText = text.replace(/\n/g, '<br>');
                outputElement.innerHTML = formattedText;
                outputElement.classList.remove('hidden');
            } else {
                outputElement.innerHTML = "Désolé, je n'ai pas pu générer de réponse. Veuillez réessayer.";
                outputElement.classList.remove('hidden');
            }
            loadingElement.classList.add('hidden');
        }

        document.addEventListener('DOMContentLoaded', () => {
            const promptSelect = document.getElementById('prompt-select');
            const generatePromptBtn = document.getElementById('generate-prompt-btn');
            const promptOutput = document.getElementById('prompt-output');
            const promptLoading = document.getElementById('prompt-loading');
            
            promptSelect.addEventListener('change', () => {
                generatePromptBtn.disabled = !promptSelect.value;
            });

            generatePromptBtn.addEventListener('click', () => {
                const task = promptSelect.value;
                if (task) {
                    const prompt = `Rédigez un prompt efficace et précis pour une IA générative, afin de l'aider à accomplir la tâche suivante : "${task}". Donnez un seul exemple de prompt.`;
                    callGeminiAPI(prompt, promptOutput, promptLoading);
                }
            });
        });
    </script>
</body>
</html>
